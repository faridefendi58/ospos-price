<form method="post" id="resource-form" class="mt20" action="{{ 'pos/outlets/update-resource' | link }}/{{ model.id }}">
    <div class="alert alert-success" style="display: none;"></div>
    <div class="col-md-12 mb10">
        <p>Kolom bertanda <span class="red">*</span> tidak boleh dikosongi</p>
    </div>
    {% set configs = detail.configs | json_decode %}
    {% set resource = configs.db %}
    <div class="col-md-6">
        <div class="form-group">
            <label for="host">Host / Alamat IP <span class="required">*</span></label>
            <input type="text" id="host" name="Outlets[host]" class="form-control" {% if resource.host %}value="{{ resource.host }}"{% endif %} required>
        </div>
        <div class="form-group">
            <label for="dbname">Nama Database <span class="required">*</span></label>
            <input type="text" id="dbname" name="Outlets[dbname]" class="form-control" {% if resource.dbname %}value="{{ resource.dbname }}"{% endif %} required>
        </div>
        <div class="form-group">
            <label for="dbuser">Database User <span class="required">*</span></label>
            <input type="text" id="dbuser" name="Outlets[dbuser]" class="form-control" {% if resource.dbuser %}value="{{ resource.dbuser }}"{% endif %} required>
        </div>
    </div>
    <div class="col-md-6">
        <div class="form-group">
            <label for="dbpassword">Database Password <span class="required">*</span></label>
            <input type="password" id="dbpassword" name="Outlets[dbpassword]" class="form-control" {% if resource.dbpassword %}value="{{ resource.dbpassword }}"{% endif %} required>
        </div>
        <div class="form-group">
            <label for="tablePrefix">Database Table Prefiks <span class="required">*</span></label>
            <input type="text" id="tablePrefix" name="Outlets[tablePrefix]" class="form-control" {% if resource.tablePrefix %}value="{{ resource.tablePrefix }}"{% endif %} required>
        </div>
    </div>
    <div class="col-md-12">
        <div class="form-group">
            <input type="submit" value="Simpan" class="btn btn-info">
        </div>
    </div>
</form>

<script type="text/javascript">
    $(function () {
        $('#resource-form').submit(function () {
            var url = $(this).attr('action');
            $.ajax({
                'url': url,
                'type':'post',
                'data': $('#resource-form').serialize(),
                'success': function(data) {
                    if (data.status == 'success') {
                        var alert_success = $('#resource-form').find('.alert-success');
                        alert_success.html(data.message);
                        alert_success.show();
                        setTimeout(function () {
                            if (data.updated == true) {
                                window.location.reload(true);
                            } else {
                                alert_success.hide();
                                alert_success.empty();
                                $('#resource-form')[0].reset();
                            }
                        }, 3000);
                    }
                }
            });

            return false;
        });
    });
</script>